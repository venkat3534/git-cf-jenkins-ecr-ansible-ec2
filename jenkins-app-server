pipeline {
 agent { label 'cicd-server' } // Ensure this runs on the CICD server

 environment {
     IMAGE_NAME = 'myapp'
     AWS_REGION = 'ap-south-1'
     ECR_REPO_URI = '506115906214.dkr.ecr.ap-south-1.amazonaws.com/myapp'
 }

 stages {
     stage('Checkout Code') {
         steps {
             git branch: 'main', url: 'https://github.com/your-repo.git'
         }
     }

     stage('Run Ansible Playbook') {
         steps {
             sh '''
             # Run the Ansible playbook to deploy the application
             ansible-playbook -i hosts deploy_app.yml
             '''
         }
     }
 }
}
